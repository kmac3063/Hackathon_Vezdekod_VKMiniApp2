{"version":3,"sources":["panels/Home.js","img/persik.png","panels/WelcomeScreen.js","App.js","index.js"],"names":["Home","id","go","fetchedUser","scheme","useState","bitsSize","Array","from","length","v","i","bitsInSecond","currentSecond","setCurrentSecond","myInterval","setMyInterval","stopPressed","clearInterval","console","log","bridge","send","style","display","size","stretched","marginRight","onClick","bits","sec","timerId","setInterval","startPressed","mode","justifyContent","overflow","map","bool","index","padding","backgroundColor","onChange","e","value","switchChange","target","WelcomeScreen","icon","header","action","data-to","App","activePanel","setActivePanel","setUser","popout","setPopout","setScheme","useEffect","a","user","then","p","is_available","alert","subscribe","detail","type","data","schemeAttribute","document","createAttribute","body","attributes","setNamedItem","fetchData","checkAvailable","currentTarget","dataset","to","ReactDOM","render","getElementById"],"mappings":"wNA+EeA,EA7DF,SAAC,GAAmC,IAAlCC,EAAiC,EAAjCA,GAGX,GAH4C,EAA7BC,GAA6B,EAAzBC,YAAyB,EAAZC,OAGAC,mBAFb,IAEnB,mBAAOC,EAAP,KACA,GADA,KACwCD,mBAASE,MAAMC,KAAK,CAACC,OAAQH,IAAW,SAACI,EAAGC,GAAJ,OAAU,OAA1F,mBAAOC,EAAP,KACA,GADA,KAC0CP,mBAAS,IAAnD,mBAAOQ,EAAP,KAAsBC,EAAtB,KACA,EAAoCT,mBAAS,MAA7C,mBAAOU,EAAP,KAAmBC,EAAnB,KAwBMC,EAAc,WAChBC,cAAcH,GACdD,EAAiB,GACjBK,QAAQC,IAAI,SACZC,IAAOC,KAAK,wBAAyB,CAAC,MAAS,KAGnD,OAAO,eAAC,IAAD,CAAOrB,GAAIA,EAAX,UACH,cAAC,IAAD,2GACA,cAAC,IAAD,UACI,eAAC,IAAD,CAAKsB,MAAO,CAACC,QAAS,QAAtB,UACI,cAAC,IAAD,CAAQC,KAAK,IAAIC,WAAS,EAACH,MAAO,CAACI,YAAa,GAAIC,QAChD,YA7BK,SAACC,GACC,OAAfd,GACAG,cAAcH,GAElB,IAAIe,EAAM,EACVhB,EAAiB,GACjBK,QAAQC,IAAIS,EAAK,IACjBR,IAAOC,KAAK,wBAAyB,CAAC,MAASO,EAAK,KACpD,IAAIE,EAAUC,aAAY,WAEtBlB,EAAuB,GADvBgB,GAAOA,EAAM,GAAMxB,IAEnBa,QAAQC,IAAIS,EAAKC,IACjBT,IAAOC,KAAK,wBAAyB,CAAC,MAASO,EAAKC,OACrD,KACHd,EAAce,GAeKE,CAAarB,IADxB,kDAEA,cAAC,IAAD,CAAQa,KAAK,IAAIC,WAAS,EAACQ,KAAK,YAAYN,QAASX,EAArD,+EAGR,eAAC,IAAD,WACI,cAAC,IAAD,CAAQiB,KAAK,YAAb,iIACA,cAAC,IAAD,CAAKX,MAAO,CAACC,QAAS,OAAQW,eAAe,gBAAiBC,SAAS,QAAvE,SACKxB,EAAayB,KAAI,SAACC,EAAMC,GACrB,OAAO,eAAC,IAAD,CAAiBhB,MAAO,CAACiB,QAAQ,IAAKC,gBAAiBF,EAAQ,IAAM1B,EAAe,UAAW,WAA/F,UACH,eAAC,IAAD,CAAKU,MAAO,CAACiB,QAAQ,KAArB,UAA4BD,EAAQ,EAApC,yBACA,cAAC,IAAD,CAASG,SAAU,SAACC,IA5CnB,SAACJ,EAAOK,GACzB3B,IACAL,EAAa2B,GAA+B,EAAtB3B,EAAa2B,GA0CQM,CAAaN,EAAOI,EAAEG,OAAOF,YAF3CL,e,GCpEtB,I,QC6BAQ,EAxBO,SAAC,GAA2B,IAA1B9C,EAAyB,EAAzBA,GAAiBC,GAAQ,EAArBC,YAAqB,EAARD,IAQrC,OACI,cAAC,IAAD,CAAOD,GAAIA,EAAX,SAEI,cAAC,IAAD,UACI,cAAC,IAAD,CACI+C,KAAM,cAAC,IAAD,IACNC,OAAQ,8HACRC,OAAQ,cAAC,IAAD,CAAQzB,KAAK,IAAIG,QAAS1B,EAAIiD,UAAQ,OAAtC,gHAHZ,uSCkDDC,EA3DH,WACR,MAAsC/C,mBAAS,iBAA/C,mBAAOgD,EAAP,KAAoBC,EAApB,KACA,EAA+BjD,mBAAS,MAAxC,mBAAOF,EAAP,KAAoBoD,EAApB,KACA,EAA4BlD,mBAAS,cAAC,IAAD,CAAeoB,KAAK,WAAzD,mBAAO+B,EAAP,KAAeC,EAAf,KACA,EAA4BpD,mBAAS,MAArC,mBAAOD,EAAP,KAAesD,EAAf,KAMAC,qBAAU,WAAM,4CAWZ,4BAAAC,EAAA,6DACIH,EAAU,MADd,SAEuBpC,IAAOC,KAAK,uBAFnC,OAEUuC,EAFV,OAGIN,EAAQM,GAHZ,4CAXY,kEAiBZ,sBAAAD,EAAA,sDACIvC,IAAOC,KAAK,wBAAwBwC,MAChC,SAACC,GACQA,EAAEC,cACHC,MAAM,8RAJtB,4CAjBY,sBACZ5C,IAAO6C,WAAU,YAA6B,IAAD,IAA1BC,OAASC,EAAiB,EAAjBA,KAAiB,EAAXC,KAC9B,GAAa,yBAATD,EAAiC,CACjC,IAAME,EAAkBC,SAASC,gBAAgB,UAEjDF,EAAgB1B,MAAQ,eACxBc,EAAUY,EAAgB1B,OAC1B2B,SAASE,KAAKC,WAAWC,aAAaL,OAPlC,mCA6BZM,GA7BY,mCA8BZC,KACD,IAEH,IAAM3E,EAAK,SAAAyC,GACPW,EAAeX,EAAEmC,cAAcC,QAAQC,KAG3C,OACI,cAAC,IAAD,UACI,cAAC,IAAD,UACI,eAAC,IAAD,CAAM3B,YAAaA,EAAaG,OAAQA,EAAxC,UACI,cAAC,EAAD,CAAevD,GAAG,gBAAgBE,YAAaA,EAAaD,GAAIA,IAChE,cAAC,EAAD,CAAMD,GAAG,OAAOE,YAAaA,EAAaD,GAAIA,EAAIE,OAAQA,YCtD9EiB,IAAOC,KAAK,gBAEZ2D,IAASC,OAAO,cAAC,EAAD,IAASX,SAASY,eAAe,W","file":"static/js/main.940d3f9d.chunk.js","sourcesContent":["import React, {useState} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {\n    Panel,\n    PanelHeader,\n    Header,\n    Button,\n    Group,\n    Cell,\n    Div,\n    Avatar,\n    SimpleCell,\n    Switch,\n    FormItem, Select\n} from '@vkontakte/vkui';\nimport bridge from \"@vkontakte/vk-bridge\";\n\nconst Home = ({id, go, fetchedUser, scheme}) => {\n    const START_SIZE = 8\n\n    const [bitsSize, setBitsSize] = useState(START_SIZE)\n    const [bitsInSecond, setBitsInSecond] = useState(Array.from({length: bitsSize}, (v, i) => 0))\n    const [currentSecond, setCurrentSecond] = useState(0)\n    const [myInterval, setMyInterval] = useState(null)\n\n    const switchChange = (index, value) => {\n        stopPressed()\n        bitsInSecond[index] = bitsInSecond[index] ^ 1\n    }\n\n    const startPressed = (bits) => {\n        if (myInterval !== null) {\n            clearInterval(myInterval)\n        }\n        let sec = 0\n        setCurrentSecond(1)\n        console.log(bits[0])\n        bridge.send(\"VKWebAppFlashSetLevel\", {\"level\": bits[0]});\n        let timerId = setInterval(() => {\n            sec = (sec + 1) % (bitsSize)\n            setCurrentSecond(sec + 1)\n            console.log(bits[sec])\n            bridge.send(\"VKWebAppFlashSetLevel\", {\"level\": bits[sec]});\n        }, 1000);\n        setMyInterval(timerId)\n    }\n\n    const stopPressed = () => {\n        clearInterval(myInterval)\n        setCurrentSecond(0)\n        console.log(\"Stop!\")\n        bridge.send(\"VKWebAppFlashSetLevel\", {\"level\": 0});\n    }\n\n    return <Panel id={id}>\n        <PanelHeader>Один-ноль фонарик</PanelHeader>\n        <Group>\n            <Div style={{display: 'flex'}}>\n                <Button size=\"l\" stretched style={{marginRight: 8}} onClick={\n                    () => {startPressed(bitsInSecond)}}>Начать</Button>\n                <Button size=\"l\" stretched mode=\"secondary\" onClick={stopPressed}>Остановить</Button>\n            </Div>\n        </Group>\n        <Group>\n            <Header mode=\"secondary\">Управление секундами</Header>\n            <Div style={{display: \"flex\", justifyContent:\"space-between\", overflow:\"auto\"}}>\n                {bitsInSecond.map((bool, index) => {\n                    return <Div key={index} style={{padding:\"0\", backgroundColor: index + 1 === currentSecond? \"#D7FDDB\": \"#FFFFFF\"}}>\n                        <Div style={{padding:\"0\"}}>{index + 1} сек</Div>\n                        <Switch  onChange={(e) => {switchChange(index, e.target.value); }}/>\n                    </Div>\n                })\n                }\n            </Div>\n        </Group>\n    </Panel>\n}\n\nexport default Home;\n","export default __webpack_public_path__ + \"static/media/persik.ae9f0072.png\";","import React from \"react\";\r\nimport {Button, Group, Panel, PanelHeader, PanelHeaderBack, Placeholder} from \"@vkontakte/vkui\";\r\nimport persik from \"../img/persik.png\";\r\nimport {Icon56UsersOutline} from \"@vkontakte/icons\";\r\n\r\nconst WelcomeScreen = ({id, fetchedUser, go}) => {\r\n    const getName = (user) => {\r\n        // if (user == null || user.first_name == null)\r\n        //     return \"Друже\"\r\n        // return fetchedUser.first_name\r\n        return \"Приятель\"\r\n    }\r\n\r\n    return (\r\n        <Panel id={id}>\r\n            {/*<PanelHeader right={<Avatar size={36} />}>Panel 1</PanelHeader>*/}\r\n            <Group>\r\n                <Placeholder\r\n                    icon={<Icon56UsersOutline />}\r\n                    header={\"Приветствуем, \" + getName(fetchedUser) + \"!\"}\r\n                    action={<Button size=\"m\" onClick={go} data-to=\"Home\">Перейти к фонарику</Button>}\r\n                >\r\n                    Приложение разработано в рамках хакатона \"Вездекод 2021\"\r\n                </Placeholder>\r\n            </Group>\r\n        </Panel>\r\n    )\r\n}\r\n\r\nexport default WelcomeScreen;","import React, {useState, useEffect} from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport {View, ScreenSpinner, AdaptivityProvider, AppRoot} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport Home from './panels/Home';\nimport WelcomeScreen from \"./panels/WelcomeScreen\";\n\nconst App = () => {\n    const [activePanel, setActivePanel] = useState('WelcomeScreen');\n    const [fetchedUser, setUser] = useState(null);\n    const [popout, setPopout] = useState(<ScreenSpinner size='large'/>);\n    const [scheme, setScheme] = useState(null)\n\n    // const schemeAttribute = document.createAttribute('scheme');\n    // schemeAttribute.value = 'dark';\n    // document.body.attributes.setNamedItem(schemeAttribute);\n\n    useEffect(() => {\n        bridge.subscribe(({detail: {type, data}}) => {\n            if (type === 'VKWebAppUpdateConfig') {\n                const schemeAttribute = document.createAttribute('scheme')\n                // schemeAttribute.value = data.scheme ? data.scheme : 'client_light';\n                schemeAttribute.value = 'client_light';\n                setScheme(schemeAttribute.value)\n                document.body.attributes.setNamedItem(schemeAttribute);\n            }\n        });\n\n        async function fetchData() {\n            setPopout(null);\n            const user = await bridge.send('VKWebAppGetUserInfo');\n            setUser(user);\n        }\n\n        async function checkAvailable() {\n            bridge.send(\"VKWebAppFlashGetInfo\").then(\n                (p) => {\n                    if (!p.is_available) {\n                        alert(\"На вашем устройстве отсутствует/не работает фонарик :(\")\n                    }\n                }\n            )\n        }\n\n\n\n        fetchData();\n        checkAvailable()\n    }, []);\n\n    const go = e => {\n        setActivePanel(e.currentTarget.dataset.to);\n    };\n\n    return (\n        <AdaptivityProvider>\n            <AppRoot>\n                <View activePanel={activePanel} popout={popout}>\n                    <WelcomeScreen id='WelcomeScreen' fetchedUser={fetchedUser} go={go}/>\n                    <Home id='Home' fetchedUser={fetchedUser} go={go} scheme={scheme}/>\n                </View>\n            </AppRoot>\n        </AdaptivityProvider>\n    );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}