{"version":3,"sources":["panels/Home.js","img/persik.png","panels/WelcomeScreen.js","App.js","index.js"],"names":["Home","id","go","fetchedUser","scheme","useState","bitsSize","setBitsSize","Array","from","length","v","i","bitsInSecond","setBitsInSecond","setEnable","currentSecond","setCurrentSecond","myInterval","setMyInterval","getString","index","switchChange","value","stopPressed","clearInterval","console","log","bridge","send","getColor","i1","i2","top","placeholder","options","res","push","label","getSecondOptions","onChange","e","parseInt","target","style","display","size","stretched","marginRight","onClick","bits","sec","timerId","setInterval","startPressed","mode","map","bool","after","backgroundColor","padding","WelcomeScreen","icon","header","action","data-to","App","activePanel","setActivePanel","setUser","popout","setPopout","setScheme","useEffect","a","user","then","p","is_available","alert","subscribe","detail","type","data","schemeAttribute","document","createAttribute","body","attributes","setNamedItem","fetchData","checkAvailable","currentTarget","dataset","to","ReactDOM","render","getElementById"],"mappings":"wNA8HeA,EA5GF,SAAC,GAAmC,IAAlCC,EAAiC,EAAjCA,GAGX,GAH4C,EAA7BC,GAA6B,EAAzBC,YAAyB,EAAZC,OAGAC,mBAFb,IAEnB,mBAAOC,EAAP,KAAiBC,EAAjB,KACA,EAAwCF,mBAASG,MAAMC,KAAK,CAACC,OAAQJ,IAAW,SAACK,EAAGC,GAAJ,OAAU,MAA1F,mBAAOC,EAAP,KAAqBC,EAArB,KACA,EAA4BT,oBAAS,GAArC,mBAAeU,GAAf,WACA,EAA0CV,mBAAS,GAAnD,mBAAOW,EAAP,KAAsBC,EAAtB,KACA,EAAoCZ,mBAAS,MAA7C,mBAAOa,EAAP,KAAmBC,EAAnB,KAEMC,EAAY,SAACC,GACf,IAAIT,EAAIS,EAAQ,EAChB,OAAIT,EAAI,KAAO,EACJA,EAAI,qDAERA,EAAI,4DAWTU,EAAe,SAACD,EAAOE,GACzBR,GAAU,GACVS,IACAX,EAAaQ,GAA+B,EAAtBR,EAAaQ,IAoBjCG,EAAc,WAChBC,cAAcP,GACdD,EAAiB,GACjBS,QAAQC,IAAI,SACZC,IAAOC,KAAK,wBAAyB,CAAC,MAAS,KAG7CC,EAAW,SAACC,EAAIC,GAClB,GAAID,IAAOC,EAAI,MAAO,WAM1B,OAAO,eAAC,IAAD,CAAO/B,GAAIA,EAAX,UACH,cAAC,IAAD,2GACA,eAAC,IAAD,WACI,cAAC,IAAD,CAAUgC,IAAI,oGAAd,SACI,cAAC,IAAD,CACIC,YAAY,6CACZC,QAnDS,WAErB,IADA,IAAIC,EAAM,GACDxB,EAAI,EAAGA,GAAK,GAAIA,IACrBwB,EAAIC,KAAK,CAACd,MAAQX,EAAI,EAAI0B,MAAO1B,EAAI,yBAEzC,OAAOwB,EA8CcG,GACThB,MAAOjB,EAAW,EAClBkC,SAAU,SAACC,GACPlC,EAAYmC,SAASD,EAAEE,OAAOpB,OAAS,GACvCT,EAAgBN,MAAMC,KAAK,CAACC,OAAQgC,SAASD,EAAEE,OAAOpB,OAAS,IAAI,SAACZ,EAAGC,GAAJ,OAAU,MAC7EY,IACAT,GAAU,QAItB,eAAC,IAAD,CAAK6B,MAAO,CAACC,QAAS,QAAtB,UACI,cAAC,IAAD,CAAQC,KAAK,IAAIC,WAAS,EAACH,MAAO,CAACI,YAAa,GAAIC,QAChD,YAjDK,SAACC,GACC,OAAfhC,GACAO,cAAcP,GAElB,IAAIiC,EAAM,EACVlC,EAAiB,GACjBS,QAAQC,IAAIuB,EAAKC,EAAM,IACvBvB,IAAOC,KAAK,wBAAyB,CAAC,MAASqB,EAAK,KACpD,IAAIE,EAAUC,aAAY,WACtBF,GAAOA,EAAM,GAAM7C,EACnBsB,IAAOC,KAAK,wBAAyB,CAAC,MAASqB,EAAKC,KACpDlC,EAAiBkC,GACjBzB,QAAQC,IAAIuB,EAAKC,MAClB,KACHhC,EAAciC,GAmCKE,CAAazC,IADxB,kDAEA,cAAC,IAAD,CAAQiC,KAAK,IAAIC,WAAS,EAACQ,KAAK,YAAYN,QAASzB,EAArD,gFAGR,eAAC,IAAD,WACI,cAAC,IAAD,CAAQ+B,KAAK,YAAb,iIACCjD,EAAW,EAAIO,EAAa2C,KAAI,SAACC,EAAMpC,GACpC,OAAO,cAAC,IAAD,CACJqC,MAAO,cAAC,IAAD,CAAQlB,SAAU,SAACC,GAAOnB,EAAaD,EAAOoB,EAAEE,OAAOpB,UAC7DqB,MAAO,CAACe,gBAAiB7B,EAAST,EAAQ,EAAGL,IAF1C,SAIFI,EAAUC,IAJSA,MAMvB,cAAC,IAAD,CAAKuB,MAAO,CAACC,QAAS,QAAtB,SACAhC,EAAa2C,KAAI,SAACC,EAAMpC,GACjB,OAAO,eAAC,IAAD,CACKuB,MAAO,CAACgB,QAAQ,IAAKD,gBAAiB7B,EAAST,EAAQ,EAAGL,IAD/D,UAEH,eAAC,IAAD,CAAK4B,MAAO,CAACgB,QAAQ,KAArB,UAA4BvC,EAAQ,EAApC,yBACA,cAAC,IAAD,CAASmB,SAAU,SAACC,GAAOnB,EAAaD,EAAOoB,EAAEE,OAAOpB,YAH3CF,e,GCjH1B,I,QC6BAwC,EAxBO,SAAC,GAA2B,IAA1B5D,EAAyB,EAAzBA,GAAiBC,GAAQ,EAArBC,YAAqB,EAARD,IAQrC,OACI,cAAC,IAAD,CAAOD,GAAIA,EAAX,SAEI,cAAC,IAAD,UACI,cAAC,IAAD,CACI6D,KAAM,cAAC,IAAD,IACNC,OAAQ,8HACRC,OAAQ,cAAC,IAAD,CAAQlB,KAAK,IAAIG,QAAS/C,EAAI+D,UAAQ,OAAtC,gHAHZ,uSCkDDC,EA3DH,WACR,MAAsC7D,mBAAS,iBAA/C,mBAAO8D,EAAP,KAAoBC,EAApB,KACA,EAA+B/D,mBAAS,MAAxC,mBAAOF,EAAP,KAAoBkE,EAApB,KACA,EAA4BhE,mBAAS,cAAC,IAAD,CAAeyC,KAAK,WAAzD,mBAAOwB,EAAP,KAAeC,EAAf,KACA,EAA4BlE,mBAAS,MAArC,mBAAOD,EAAP,KAAeoE,EAAf,KAMAC,qBAAU,WAAM,4CAWZ,4BAAAC,EAAA,6DACIH,EAAU,MADd,SAEuB3C,IAAOC,KAAK,uBAFnC,OAEU8C,EAFV,OAGIN,EAAQM,GAHZ,4CAXY,kEAiBZ,sBAAAD,EAAA,sDACI9C,IAAOC,KAAK,wBAAwB+C,MAChC,SAACC,GACQA,EAAEC,cACHC,MAAM,8RAJtB,4CAjBY,sBACZnD,IAAOoD,WAAU,YAA6B,IAAD,IAA1BC,OAASC,EAAiB,EAAjBA,KAAiB,EAAXC,KAC9B,GAAa,yBAATD,EAAiC,CACjC,IAAME,EAAkBC,SAASC,gBAAgB,UAEjDF,EAAgB7D,MAAQ,eACxBiD,EAAUY,EAAgB7D,OAC1B8D,SAASE,KAAKC,WAAWC,aAAaL,OAPlC,mCA6BZM,GA7BY,mCA8BZC,KACD,IAEH,IAAMzF,EAAK,SAAAuC,GACP2B,EAAe3B,EAAEmD,cAAcC,QAAQC,KAG3C,OACI,cAAC,IAAD,UACI,cAAC,IAAD,UACI,eAAC,IAAD,CAAM3B,YAAaA,EAAaG,OAAQA,EAAxC,UACI,cAAC,EAAD,CAAerE,GAAG,gBAAgBE,YAAaA,EAAaD,GAAIA,IAChE,cAAC,EAAD,CAAMD,GAAG,OAAOE,YAAaA,EAAaD,GAAIA,EAAIE,OAAQA,YCtD9EwB,IAAOC,KAAK,gBAEZkE,IAASC,OAAO,cAAC,EAAD,IAASX,SAASY,eAAe,W","file":"static/js/main.c5b66a7b.chunk.js","sourcesContent":["import React, {useState} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {\n    Panel,\n    PanelHeader,\n    Header,\n    Button,\n    Group,\n    Cell,\n    Div,\n    Avatar,\n    SimpleCell,\n    Switch,\n    FormItem, Select\n} from '@vkontakte/vkui';\nimport bridge from \"@vkontakte/vk-bridge\";\n\nconst Home = ({id, go, fetchedUser, scheme}) => {\n    const START_SIZE = 8\n\n    const [bitsSize, setBitsSize] = useState(START_SIZE)\n    const [bitsInSecond, setBitsInSecond] = useState(Array.from({length: bitsSize}, (v, i) => 0))\n    const [enable, setEnable] = useState(false)\n    const [currentSecond, setCurrentSecond] = useState(0)\n    const [myInterval, setMyInterval] = useState(null)\n\n    const getString = (index) => {\n        let i = index + 1\n        if (i % 10 === 3) {\n            return i + \"-я секунда\"\n        }\n        return i + \"-ая секунда\"\n    }\n\n    const getSecondOptions = () => {\n        let res = []\n        for (let i = 1; i <= 60; i++) {\n            res.push({value: (i - 1), label: i + \" сек.\"})\n        }\n        return res\n    }\n\n    const switchChange = (index, value) => {\n        setEnable(false)\n        stopPressed()\n        bitsInSecond[index] = bitsInSecond[index] ^ 1\n    }\n\n    const startPressed = (bits) => {\n        if (myInterval !== null) {\n            clearInterval(myInterval)\n        }\n        let sec = 1\n        setCurrentSecond(1)\n        console.log(bits[sec - 1])\n        bridge.send(\"VKWebAppFlashSetLevel\", {\"level\": bits[0]});\n        let timerId = setInterval(() => {\n            sec = (sec + 1) % (bitsSize)\n            bridge.send(\"VKWebAppFlashSetLevel\", {\"level\": bits[sec]});\n            setCurrentSecond(sec)\n            console.log(bits[sec])\n        }, 1000);\n        setMyInterval(timerId)\n    }\n\n    const stopPressed = () => {\n        clearInterval(myInterval)\n        setCurrentSecond(0)\n        console.log(\"Stop!\")\n        bridge.send(\"VKWebAppFlashSetLevel\", {\"level\": 0});\n    }\n\n    const getColor = (i1, i2) => {\n        if (i1 === i2) return \"#D7FDDB\"\n        if (scheme === '') return\n        else return\n        return i1 === currentSecond? \"\": \"#FFFFFF\"\n    }\n\n    return <Panel id={id}>\n        <PanelHeader>Один-ноль фонарик</PanelHeader>\n        <Group>\n            <FormItem top=\"Количество секунд\">\n                <Select\n                    placeholder=\"Выбрать\"\n                    options={getSecondOptions()}\n                    value={bitsSize - 1}\n                    onChange={(e) => {\n                        setBitsSize(parseInt(e.target.value) + 1)\n                        setBitsInSecond(Array.from({length: parseInt(e.target.value) + 1}, (v, i) => 0))\n                        stopPressed()\n                        setEnable(false)\n                    }}\n                />\n            </FormItem>\n            <Div style={{display: 'flex'}}>\n                <Button size=\"l\" stretched style={{marginRight: 8}} onClick={\n                    () => {startPressed(bitsInSecond)}}>Начать</Button>\n                <Button size=\"l\" stretched mode=\"secondary\" onClick={stopPressed}>Остановить</Button>\n            </Div>\n        </Group>\n        <Group>\n            <Header mode=\"secondary\">Управление секундами</Header>\n            {bitsSize > 8 ? bitsInSecond.map((bool, index) => {\n                return <SimpleCell key={index}\n                   after={<Switch onChange={(e) => {switchChange(index, e.target.value); }}/>}\n                    style={{backgroundColor: getColor(index + 1, currentSecond)}}\n                >\n                    {getString(index)}\n                </SimpleCell>\n            }) : <Div style={{display: \"flex\"}}>\n                {bitsInSecond.map((bool, index) => {\n                        return <Div key={index}\n                                    style={{padding:\"0\", backgroundColor: getColor(index + 1, currentSecond)}}>\n                            <Div style={{padding:\"0\"}}>{index + 1} сек</Div>\n                            <Switch  onChange={(e) => {switchChange(index, e.target.value); }}/>\n                        </Div>\n                    })\n                }\n            </Div>\n            }\n        </Group>\n    </Panel>\n}\n\nexport default Home;\n","export default __webpack_public_path__ + \"static/media/persik.ae9f0072.png\";","import React from \"react\";\r\nimport {Button, Group, Panel, PanelHeader, PanelHeaderBack, Placeholder} from \"@vkontakte/vkui\";\r\nimport persik from \"../img/persik.png\";\r\nimport {Icon56UsersOutline} from \"@vkontakte/icons\";\r\n\r\nconst WelcomeScreen = ({id, fetchedUser, go}) => {\r\n    const getName = (user) => {\r\n        // if (user == null || user.first_name == null)\r\n        //     return \"Друже\"\r\n        // return fetchedUser.first_name\r\n        return \"Приятель\"\r\n    }\r\n\r\n    return (\r\n        <Panel id={id}>\r\n            {/*<PanelHeader right={<Avatar size={36} />}>Panel 1</PanelHeader>*/}\r\n            <Group>\r\n                <Placeholder\r\n                    icon={<Icon56UsersOutline />}\r\n                    header={\"Приветствуем, \" + getName(fetchedUser) + \"!\"}\r\n                    action={<Button size=\"m\" onClick={go} data-to=\"Home\">Перейти к фонарику</Button>}\r\n                >\r\n                    Приложение разработано в рамках хакатона \"Вездекод 2021\"\r\n                </Placeholder>\r\n            </Group>\r\n        </Panel>\r\n    )\r\n}\r\n\r\nexport default WelcomeScreen;","import React, {useState, useEffect} from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport {View, ScreenSpinner, AdaptivityProvider, AppRoot} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport Home from './panels/Home';\nimport WelcomeScreen from \"./panels/WelcomeScreen\";\n\nconst App = () => {\n    const [activePanel, setActivePanel] = useState('WelcomeScreen');\n    const [fetchedUser, setUser] = useState(null);\n    const [popout, setPopout] = useState(<ScreenSpinner size='large'/>);\n    const [scheme, setScheme] = useState(null)\n\n    // const schemeAttribute = document.createAttribute('scheme');\n    // schemeAttribute.value = 'dark';\n    // document.body.attributes.setNamedItem(schemeAttribute);\n\n    useEffect(() => {\n        bridge.subscribe(({detail: {type, data}}) => {\n            if (type === 'VKWebAppUpdateConfig') {\n                const schemeAttribute = document.createAttribute('scheme')\n                // schemeAttribute.value = data.scheme ? data.scheme : 'client_light';\n                schemeAttribute.value = 'client_light';\n                setScheme(schemeAttribute.value)\n                document.body.attributes.setNamedItem(schemeAttribute);\n            }\n        });\n\n        async function fetchData() {\n            setPopout(null);\n            const user = await bridge.send('VKWebAppGetUserInfo');\n            setUser(user);\n        }\n\n        async function checkAvailable() {\n            bridge.send(\"VKWebAppFlashGetInfo\").then(\n                (p) => {\n                    if (!p.is_available) {\n                        alert(\"На вашем устройстве отсутствует/не работает фонарик :(\")\n                    }\n                }\n            )\n        }\n\n\n\n        fetchData();\n        checkAvailable()\n    }, []);\n\n    const go = e => {\n        setActivePanel(e.currentTarget.dataset.to);\n    };\n\n    return (\n        <AdaptivityProvider>\n            <AppRoot>\n                <View activePanel={activePanel} popout={popout}>\n                    <WelcomeScreen id='WelcomeScreen' fetchedUser={fetchedUser} go={go}/>\n                    <Home id='Home' fetchedUser={fetchedUser} go={go} scheme={scheme}/>\n                </View>\n            </AppRoot>\n        </AdaptivityProvider>\n    );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}